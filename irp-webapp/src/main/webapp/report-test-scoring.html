<script src="js/irp.js"></script>
<polymer-element name="report-test-scoring" attributes="response">
    <template>
        <link rel="stylesheet" href="css/report.css"/>

        <template bind="{{response.opportunityCategory.tdsReportScoreIrpScoredScore as scoreInfo}}">
        <template if="{{!scoreInfo.scoredTDSReport}}">
            <div style="background: #FFFFE0 none repeat scroll 0% 0%;padding: 10px;border: 1px solid #000;">
                There was an internal server error that prevented validation of Test Scoring. Please resubmit the TDSReport to try again.
            </div>
        </template>

        <template if="{{!scoreInfo.scoreMatch && scoreInfo.scoredTDSReport}}">
            <div style="background: #FFFFE0 none repeat scroll 0% 0%;padding: 10px;border: 1px solid #000;">
            Not all of the Measures matched those computed by IRP. Please see the analysis below.
            </div>
        </template>
        </template>

        <h4 align="center">Measures that match IRP's computed Measures</h4>
        <table class="tableAnalysis">
            <thead>
            <tr>
                <th>Measure Of</th>
                <th>Measure Label</th>
                <th>Value</th>
                <th>Standard Error</th>
            </tr>
            </thead>
            <tbody>
            <template bind="{{response.opportunityCategory.tdsReportScoreIrpScoredScore.matchedScoresMap as matchedScores}}">
                <template repeat="{{score, index in matchedScores | getKeys}}">
                <tr class="opportunityScore {{oddOrEvenClass(index)}}">
                    <td>{{matchedScores[score].measureOf}}</td>
                    <td>{{matchedScores[score].measureLabel}}</td>
                    <td>{{matchedScores[score].value}}</td>
                    <td>{{matchedScores[score].standardError}}</td>
                </tr>
                </template>
            </template>
            </tbody>
        </table>

        <h4 align="center" style="margin-bottom:0px;">Measures that did not match IRP's computed Measures</h4>
        <p style="text-align: center;">(The measure's value and/or standard error did not match what IRP computed)</p>
        <table class="tableAnalysis">
            <thead>
            <tr>
                <th></th>
                <th>Measure Of</th>
                <th>Measure Label</th>
                <th>Value</th>
                <th>Standard Error</th>
            </tr>
            </thead>
            <tbody>
            <template repeat="{{nonMatchedPairs, index in response.opportunityCategory.tdsReportScoreIrpScoredScore.notMatchPairs}}">
                <tr class="opportunityScore {{oddOrEvenClass(index)}}">
                    <td style="font-size:small;font-weight:bold">TDS Report's Measure:</td>
                    <td>{{nonMatchedPairs.tdsReportScore.measureOf}}</td>
                    <td>{{nonMatchedPairs.tdsReportScore.measureLabel}}</td>
                    <td style="font-size:medium">{{nonMatchedPairs.tdsReportScore.value}}</td>
                    <td style="font-size:medium">{{nonMatchedPairs.tdsReportScore.standardError}}</td>
                </tr>
                <tr class="opportunityScore {{oddOrEvenClass(index)}}">
                    <td style="font-size:small;font-weight:bold">IRP's Computed Measure:</td>
                    <td>{{nonMatchedPairs.irpScoredScore.measureOf}}</td>
                    <td>{{nonMatchedPairs.irpScoredScore.measureLabel}}</td>
                    <td style="font-size:medium">{{nonMatchedPairs.irpScoredScore.value}}</td>
                    <td style="font-size:medium">{{nonMatchedPairs.irpScoredScore.standardError}}</td>
                </tr>
            </template>
            <template if="{{response.opportunityCategory.tdsReportScoreIrpScoredScore.scoreMatch}}">
                <tr>
                    <td colspan="5" style="font-size:large;font-weight: bold">All measures matched IRP's computed measures.</td>
                </tr>
            </template>
            </tbody>
        </table>

        <h4 align="center" style="margin-bottom:0px;">Expected Measures that are missing from the TDSReport</h4>
        <p style="text-align: center;">(IRP expected to see these measures in the TDSReport but did not find them)</p>
        <table class="tableAnalysis">
            <thead>
            <tr>
                <th>Measure Of</th>
                <th>Measure Label</th>
                <th>Value</th>
                <th>Standard Error</th>
            </tr>
            </thead>
            <tbody>
            <template bind="{{response.opportunityCategory.tdsReportScoreIrpScoredScore.missedIrpScoredScoreMap as missingScores}}">
                <template repeat="{{score, index in missingScores | getKeys}}">
                    <tr class="opportunityScore {{oddOrEvenClass(index)}}">
                        <td>{{missingScores[score].measureOf}}</td>
                        <td>{{missingScores[score].measureLabel}}</td>
                        <td>{{missingScores[score].value}}</td>
                        <td>{{missingScores[score].standardError}}</td>
                    </tr>
                </template>
            </template>
            </tbody>
        </table>

        <h4 align="center">Extra Measures that were found in the TDSReport that IRP did not compute</h4>
        <table class="tableAnalysis">
            <thead>
            <tr>
                <th>Measure Of</th>
                <th>Measure Label</th>
                <th>Value</th>
                <th>Standard Error</th>
            </tr>
            </thead>
            <tbody>
            <template bind="{{response.opportunityCategory.tdsReportScoreIrpScoredScore.extraTdsReportScoreMap as extraScores}}">
                <template repeat="{{score, index in extraScores | getKeys}}">
                    <tr class="opportunityScore {{oddOrEvenClass(index)}}">
                        <td>{{extraScores[score].measureOf}}</td>
                        <td>{{extraScores[score].measureLabel}}</td>
                        <td>{{extraScores[score].value}}</td>
                        <td>{{extraScores[score].standardError}}</td>
                    </tr>
                </template>
            </template>
            </tbody>
        </table>

    </template>
    <script>
        Polymer("report-test-scoring", irp);
    </script>
</polymer-element>