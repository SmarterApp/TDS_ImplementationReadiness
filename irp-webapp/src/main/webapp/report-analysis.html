<link rel="import" href="deps/polymer/polymer.html">
<link rel="import" href="deps/paper-tabs/paper-tabs.html">
<link rel="import" href="deps/core-pages/core-pages.html">
<link rel="import" href="deps/core-media-query/core-media-query.html"/>
<link rel="import" href="report-raw-view.html"/>
<link rel="import" href="report-test-properties.html"/>
<link rel="import" href="report-examinee-info.html"/>
<link rel="import" href="report-opportunity.html"/>
<link rel="import" href="report-test-scoring.html"/>
<link rel="import" href="report-comment-toolusage.html"/>

<polymer-element name="report-analysis" attributes="response">
    <template>
        <style>
            paper-tabs, core-toolbar {
                background-color: #00bcd4;
                color: #000;
                box-shadow: 0px 3px 2px rgba(0, 0, 0, 0.2);
            }

            core-toolbar paper-tabs {
                box-shadow: none;
            }

            paper-tabs[noink][nobar] paper-tab.core-selected {
                color: #ffff8d;
            }

            paper-tabs.transparent-teal {
                background-color: transparent;
                color: #00bcd4;
                box-shadow: none;
            }

            paper-tabs.transparent-teal::shadow #selectionBar {
                background-color: #00bcd4;
            }

            paper-tabs.transparent-teal paper-tab::shadow #ink {
                color: #00bcd4;
            }

            core-pages > .core-selected {
                position: relative;
                display: block;
            }
        </style>

        <template if="{{!response.validXMLfile}}">
            <p>IRP was unable to validate and analyze this file.</p>
        </template>

        <p>Click the Home tab to download a PDF version of this IRP analysis.</p>

        <p>
            <em>Explanation</em> Codes - Each field is analyzed according to its type.
            <ul>
                <li><em>P</em> type: Field is not empty with correct data type and acceptable value.</li>
                <li><em>PC</em> type: Same as P plus verified the value is correct</li>
            </ul>
        </p>

        <paper-tabs id="scrollableTabs" selected="{{selected}}" scrollable>
            <paper-tab>Test Properties</paper-tab>
            <paper-tab>Examinee Information</paper-tab>
            <paper-tab>Opportunity</paper-tab>
            <paper-tab>Test Scoring</paper-tab>
            <paper-tab>Comments &amp; Tool Usage</paper-tab>
            <paper-tab>Raw View</paper-tab>
        </paper-tabs>

        <core-pages selected="{{selected}}">
            <div id="test-properties">
                <report-test-properties response="{{response}}"></report-test-properties>
            </div>
            <div id="examinee-info">
                <report-examinee-info response="{{response}}"></report-examinee-info>
            </div>
            <div id="opportunity">
                <report-opportunity response="{{response}}"></report-opportunity>
            </div>
            <div id="test-scoring">
                <report-test-scoring response="{{response}}"></report-test-scoring>
            </div>
            <div id="comments-tool-usage">
                <report-comment-toolusage response="{{response}}"></report-comment-toolusage>
            </div>
            <div id="raw-view">
                <report-raw-view response="{{response}}"></report-raw-view>
            </div>
        </core-pages>

        <p>The following fields are still under development: Opportunity Accommodation fields, Opportunity Score fields, and Opportunity Item ScoreInfo fields.  Please disregard any associated error messages pertaining to them.</p>

        <!-- detect when window is narrow -->
        <core-media-query id="mediaQuery" query="max-width: 640px"></core-media-query>
    </template>
    <script>
        Polymer("report-analysis", {
            created: function() {
                this.response = {};
            }
        });
        var mediaQuery = document.querySelector('#mediaQuery');
        if (mediaQuery) {
            mediaQuery.addEventListener('core-media-change',
                    function (e) {
                        document.body.classList.toggle('core-narrow', e.detail.matches);
                        document.querySelector('#scrollableTabs').updateBar();
                    });
        }
    </script>
</polymer-element>