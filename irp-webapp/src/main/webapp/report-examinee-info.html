<polymer-element name="report-examinee-info" attributes="response">
    <template>
        <link rel="stylesheet" href="css/report.css"/>

        <table class="tableAnalysis">
            <thead>
            <tr>
                <th>Parameter</th>
                <th>Expected Value</th>
                <th>Returned Value</th>
                <th>Status</th>
                <th>Explanation</th>
            </tr>
            </thead>
            <tbody>

            <template bind="{{response.examineeCategory as category}}">
                <template repeat="{{cell in category.cellCategories}}">
                    <tr>
                        <td>Examinee: {{cell.tdsFieldName}}</td>
                        <td>{{cell.tdsExpectedValue}}</td>
                        <td>{{cell.tdsFieldNameValue}}</td>
                        <td>{{cell.fieldCheckType | status}}</td>
                        <td>{{cell.fieldCheckType | explanation}}</td>
                    </tr>
                </template>
            </template>

            <template repeat="{{category in response.examineeAttributeCategories}}">
                <template repeat="{{cell in category.cellCategories}}">
                    <tr>
                        <td>ExamineeAttribute: {{cell.tdsFieldName}}</td>
                        <td>{{cell.tdsExpectedValue}}</td>
                        <td>{{cell.tdsFieldNameValue}}</td>
                        <td>{{cell.fieldCheckType | status}}</td>
                        <td>{{cell.fieldCheckType | explanation}}</td>
                    </tr>
                </template>
            </template>

            <template repeat="{{category in response.examineeRelationshipCategories}}">
                <template repeat="{{cell in category.cellCategories}}">
                    <tr>
                        <td>ExamineeRelationship: {{cell.tdsFieldName}}</td>
                        <td>{{cell.tdsExpectedValue}}</td>
                        <td>{{cell.tdsFieldNameValue}}</td>
                        <td>{{cell.fieldCheckType | status}}</td>
                        <td>{{cell.fieldCheckType | explanation}}</td>
                    </tr>
                </template>
            </template>

            </tbody>
        </table>
    </template>
    <script>
        Polymer("report-examinee-info", {
            created: function() {
                this.response = {};
            },
            status: function(input) {
                if (!input) { return ""; }
                if (input.enumfieldCheckType == 'D') { return "Ignored"; }

                var valid = !input.fieldEmpty && input.correctDataType && input.acceptableValue;

                if (input.enumfieldCheckType == 'PC') {
                    valid = valid && input.correctValue;
                }

                return valid ? "No Errors" : "Errors Found";
            },
            explanation: function(input) {
                if (!input) { return ""; }
                if (input.enumfieldCheckType == 'D') { return ""; }

                var reasons = [input.enumfieldCheckType];
                if (input.fieldEmpty) reasons.push("Field Empty");
                if (!input.correctDataType) reasons.push("Incorrect Data Type");
                if (!input.acceptableValue) reasons.push("Unacceptable Value");

                if (input.enumfieldCheckType == 'PC') {
                    if (!input.correctValue) reasons.push("Incorrect Value");
                }

                return reasons.join();
            }
        });
    </script>
</polymer-element>